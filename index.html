<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular Arquitectura</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
  background:#f4f7ef;
  padding:30px;
  color:#2f3a1f;
}
h1{
  text-align:center;
  color:#6f8440;
  letter-spacing:3px;
}
.progreso-box{
  max-width:900px;
  margin:20px auto;
  text-align:center;
}
#mensaje{
  margin-top:10px;
  font-size:0.9em;
  color:#6f8440;
}
.progreso-barra{
  background:#dde6d3;
  border-radius:20px;
  overflow:hidden;
  height:18px;
}
.progreso-barra div{
  background:#8fa86b;
  height:100%;
  width:0%;
  transition:0.5s;
}
button{
  margin-top:15px;
  background:#8fa86b;
  color:white;
  border:none;
  padding:10px 25px;
  border-radius:25px;
  cursor:pointer;
}
button:hover{background:#6f8440}

.malla{
  display:flex;
  gap:25px;
  overflow-x:auto;
  padding-top:30px;
}
.ano{
  background:#eef3e7;
  border-radius:20px;
  padding:20px;
  min-width:300px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
}
.ano h2{
  text-align:center;
  color:#6f8440;
  border-bottom:2px solid #b7c8a0;
  padding-bottom:8px;
}
.semestre h3{
  background:#dce7cb;
  text-align:center;
  border-radius:15px;
  padding:6px;
  margin-top:15px;
}
.materia{
  background:#ffffff;
  border-radius:12px;
  padding:8px;
  margin:6px 0;
  text-align:center;
  cursor:pointer;
  position:relative;
  font-size:0.85em;
}
.materia.aprobada{
  background:#8fa86b;
  color:white;
  text-decoration:line-through;
}
.materia.bloqueada{
  background:#e0e0e0;
  color:#9a9a9a;
  cursor:not-allowed;
}
.materia.bloqueada:hover::after{
  content:attr(data-tooltip);
  position:absolute;
  bottom:120%;
  left:50%;
  transform:translateX(-50%);
  background:#6f8440;
  color:white;
  padding:6px 10px;
  border-radius:10px;
  font-size:0.7em;
  white-space:nowrap;
}
</style>
</head>

<body>

<h1>MALLA CURRICULAR ARQUITECTURA</h1>
<div style="text-align:center;">
  <button onclick="loginGoogle()">Iniciar sesi√≥n con Google</button>
  <button onclick="logout()">Cerrar sesi√≥n</button>
  <p id="estadoLogin">Sin iniciar sesi√≥n</p>
</div>
  
<div class="progreso-box">
  <p id="porcentaje">Progreso: 0%</p>
  <div class="progreso-barra"><div id="barra"></div></div>
  <p id="mensaje"></p>
  <button onclick="reiniciar()">Reiniciar progreso</button>
</div>

<div class="malla" id="malla"></div>

<script>
const mensajes = [
 {p:0, m:"Todo gran proyecto empieza con una idea üå±"},
 {p:10, m:"Vas tomando forma, sigue as√≠ ‚úèÔ∏è"},
 {p:25, m:"Ya est√°s construyendo bases s√≥lidas üß±"},
 {p:50, m:"Mitad del camino, tu esfuerzo se nota üíö"},
 {p:75, m:"Casi arquitecta, no te detengas üèóÔ∏è"},
 {p:90, m:"Est√°s muy cerca del sue√±o ‚ú®"},
 {p:100, m:"¬°LO LOGRASTE! Arquitecta en proceso üéì"}
];

const data = [
{a√±o:"A√ëO 1", semestres:[
{nombre:"1¬∞ SEMESTRE", materias:[
"Dise√±o Arquitect√≥nico 1","Composici√≥n Arquitect√≥nica 1","Introducci√≥n A La Teor√≠a",
"Arte: Antig√ºedad A S. XVIII","Representaci√≥n Arquitect√≥nica 1",
"Introducci√≥n A La Edificaci√≥n","Matem√°tica Aplicada"]},
{nombre:"2¬∞ SEMESTRE", materias:[
{n:"F√≠sica Aplicada",p:["Matem√°tica Aplicada"]},
{n:"Dise√±o Arquitect√≥nico 2",p:["Dise√±o Arquitect√≥nico 1","Composici√≥n Arquitect√≥nica 1","Introducci√≥n A La Teor√≠a","Representaci√≥n Arquitect√≥nica 1","Introducci√≥n A La Edificaci√≥n"]},
{n:"Composici√≥n Arquitect√≥nica 2",p:["Composici√≥n Arquitect√≥nica 1","Dise√±o Arquitect√≥nico 1"]},
{n:"Sistemas Constructivos B√°sicos",p:["Introducci√≥n A La Edificaci√≥n"]},
{n:"Arte: Moderno Y Contempor√°neo",p:["Arte: Antig√ºedad A S. XVIII"]},
{n:"Topograf√≠a",p:["Introducci√≥n A La Edificaci√≥n","Matem√°tica Aplicada"]},
"Dibujo A Mano Alzada"]},
{nombre:"VERANO", materias:[
{n:"Taller De Dise√±o Arquitect√≥nico 1",p:["Representaci√≥n Arquitect√≥nica 1","Dise√±o Arquitect√≥nico 2"]},
"Taller De Visualizaci√≥n","Geom√°tica"]}]},
{a√±o:"A√ëO 2", semestres:[
{nombre:"1¬∞ SEMESTRE", materias:[
"Espa√±ol",
{n:"Dise√±o Arquitect√≥nico 3",p:["Introducci√≥n A La Teor√≠a","Dise√±o Arquitect√≥nico 2","Composici√≥n Arquitect√≥nica 2","Sistemas Constructivos B√°sicos","Topograf√≠a","Taller De Dise√±o Arquitect√≥nico 1"]},
{n:"Interpretaci√≥n De La Arquitectura",p:["Introducci√≥n A La Teor√≠a"]},
{n:"Representaci√≥n Arquitect√≥nica 2",p:["Representaci√≥n Arquitect√≥nica 1"]},
{n:"Tecnolog√≠a Del Hormig√≥n Armado",p:["Introducci√≥n A La Edificaci√≥n","Sistemas Constructivos B√°sicos"]},
{n:"Modelos Estructurales",p:["F√≠sica Aplicada"]},
"Introducci√≥n A La Investigaci√≥n"]},
{nombre:"2¬∞ SEMESTRE", materias:[
"Ingl√©s",
{n:"Sociedad Medio Ambiente Y Des.",p:["Dise√±o Arquitect√≥nico 3","Introducci√≥n A La Edificaci√≥n"]},
{n:"Dise√±o Arquitect√≥nico 4",p:["Dise√±o Arquitect√≥nico 3","Interpretaci√≥n De La Arquitectura","Representaci√≥n Arquitect√≥nica 2","Tecnolog√≠a Del Hormig√≥n Armado"]},
{n:"Textos Y Contextos De La Arq. Latinoamericana",p:["Interpretaci√≥n De La Arquitectura"]},
{n:"Representaci√≥n Arquitect√≥nica 3",p:["Representaci√≥n Arquitect√≥nica 2"]},
{n:"Sistemas Constructivos Especiales",p:["Tecnolog√≠a Del Hormig√≥n Armado"]},
{n:"An√°lisis Estructural",p:["Modelos Estructurales"]}]},
{nombre:"VERANO", materias:[
{n:"Taller De Dise√±o Arquitect√≥nico 2",p:["Taller De Dise√±o Arquitect√≥nico 1","Dise√±o Arquitect√≥nico 4","Representaci√≥n Arquitect√≥nica 3","Sistemas Constructivos Especiales"]},
"Electiva 1","Electiva 2"]}]},
{a√±o:"A√ëO 3", semestres:[
{nombre:"1¬∞ SEMESTRE", materias:[
"Historia De Pma En El Mundo Global",
{n:"Dise√±o Arquitect√≥nico 5",p:["Dise√±o Arquitect√≥nico 4","Textos Y Contextos De La Arq. Latinoamericana","Representaci√≥n Arquitect√≥nica 3","Sistemas Constructivos Especiales","Taller De Dise√±o Arquitect√≥nico 2"]},
{n:"Cr√≠tica De La Arquitectura Y Pensamiento Contempor√°neo",p:["Textos Y Contextos De La Arq. Latinoamericana"]},
{n:"Representaci√≥n Arquitect√≥nica 4",p:["Representaci√≥n Arquitect√≥nica 3"]},
{n:"Sistemas Constructivos Complejos",p:["Sistemas Constructivos Especiales"]},
{n:"Instalaciones Para Edificio 1",p:["F√≠sica Aplicada"]},
{n:"Espacios Abiertos Vecinales",p:["Sociedad Medio Ambiente Y Des.","Topograf√≠a","Introducci√≥n A La Investigaci√≥n","Dise√±o Arquitect√≥nico 4"]}]},
{nombre:"2¬∞ SEMESTRE", materias:[
"Geograf√≠a De Panam√°",
{n:"Dise√±o Arquitect√≥nico 6",p:["Dise√±o Arquitect√≥nico 5","Cr√≠tica De La Arquitectura Y Pensamiento Contempor√°neo","Representaci√≥n Arquitect√≥nica 4","Sistemas Constructivos Complejos","Instalaciones Para Edificio 1"]},
{n:"Arquitectura Y Ciudad 1",p:["Arte: Moderno Y Contempor√°neo"]},
{n:"Representaci√≥n Arquitect√≥nica 5",p:["Representaci√≥n Arquitect√≥nica 4"]},
{n:"Gesti√≥n De Seguridad Y Salud Ocupacional",p:["Sistemas Constructivos Complejos"]},
{n:"Instalaciones Para Edificio 2",p:["Instalaciones Para Edificio 1"]},
{n:"Ciudad Y Comunidad",p:["Dise√±o Arquitect√≥nico 5","Espacios Abiertos Vecinales"]}]},
{nombre:"VERANO", materias:[
{n:"Taller De Dise√±o Arquitect√≥nico 3",p:["Taller De Dise√±o Arquitect√≥nico 2","Sistemas Constructivos Complejos","Dise√±o Arquitect√≥nico 5","Representaci√≥n Arquitect√≥nica 5"]},
{n:"Pr√°ctica Supervisada 1",p:["Gesti√≥n De Seguridad Y Salud Ocupacional"]},
"Optativa 1"]}]},
{a√±o:"A√ëO 4", semestres:[
{nombre:"1¬∞ SEMESTRE", materias:[
{n:"Dise√±o Arquitect√≥nico 7",p:["Sistemas Constructivos Complejos","Dise√±o Arquitect√≥nico 6","Instalaciones Para Edificio 2","Taller De Dise√±o Arquitect√≥nico 3","Representaci√≥n Arquitect√≥nica 5"]},
{n:"Arquitectura Y Ciudad 2",p:["Arquitectura Y Ciudad 1"]},
{n:"Representaci√≥n Arquitect√≥nica 6",p:["Representaci√≥n Arquitect√≥nica 5"]},
{n:"Taller De Planos Y Especificaciones",p:["Introducci√≥n A La Investigaci√≥n"]},
{n:"Dise√±o Estructural Simplificado",p:["An√°lisis Estructural","Sistemas Constructivos Complejos"]},
{n:"Instalaciones Para Edificio 3",p:["Instalaciones Para Edificio 2"]},
{n:"Urbanismo",p:["Geom√°tica","Dise√±o Arquitect√≥nico 6","Ciudad Y Comunidad"]}]},
{nombre:"2¬∞ SEMESTRE", materias:[
{n:"Dise√±o Arquitect√≥nico 8",p:["Dise√±o Arquitect√≥nico 7","Representaci√≥n Arquitect√≥nica 6","Dise√±o Estructural Simplificado","Instalaciones Para Edificio 3"]},
{n:"Arquitectura Y Ciudad 3",p:["Arquitectura Y Ciudad 2"]},
{n:"Presupuesto De Obra",p:["Sistemas Constructivos Complejos","Taller De Planos Y Especificaciones"]},
{n:"Estructuras Especiales",p:["Dise√±o Estructural Simplificado"]},
{n:"Instalaciones Para Edificios 4",p:["Instalaciones Para Edificio 3"]},
{n:"Espacios Abiertos Urbanos",p:["Dise√±o Arquitect√≥nico 7","Urbanismo"]},
{n:"Metodolog√≠a Para La Elaboraci√≥n De Tesis",p:["Dise√±o Arquitect√≥nico 7","Arquitectura Y Ciudad 2","Representaci√≥n Arquitect√≥nica 6","Taller De Planos Y Especificaciones","Dise√±o Estructural Simplificado","Instalaciones Para Edificio 3","Urbanismo"]}]},
{nombre:"VERANO", materias:[
{n:"Taller De Urbanismo",p:["Dise√±o Arquitect√≥nico 8","Espacios Abiertos Urbanos"]},
{n:"Pr√°ctica Supervisada 2",p:["Pr√°ctica Supervisada 1"]},
"Optativa 2"]}]},
{a√±o:"A√ëO 5", semestres:[
{nombre:"1¬∞ SEMESTRE", materias:[
"Hist. De Las Relaciones De Pma Con Los EE.UU. I",
{n:"Dise√±o Arquitect√≥nico 9",p:["Dise√±o Arquitect√≥nico 8","Estructuras Especiales","Instalaciones Para Edificios 4"]},
{n:"Arquitectura Y Ciudad 4",p:["Arquitectura Y Ciudad 3"]},
{n:"Programaci√≥n Y Control De PYT",p:["Taller De Planos Y Especificaciones","Presupuesto De Obra"]},
{n:"Gesti√≥n Profesional",p:["Dise√±o Arquitect√≥nico 8","Pr√°ctica Supervisada 2"]},
{n:"Ciudad Y Territorio",p:["Taller De Urbanismo"]},
"Trabajo De Graduaci√≥n 1"]},
{nombre:"2¬∞ SEMESTRE", materias:[
"Hist. De Las Relaciones De Pma Con Los EE.UU. II",
{n:"Dise√±o Arquitect√≥nico 10",p:["Dise√±o Arquitect√≥nico 9"]},
{n:"Patrimonio Arquitect√≥nico",p:["Arquitectura Y Ciudad 4"]},
{n:"Gesti√≥n Y Mantenimiento De Edificios",p:["Pr√°ctica Supervisada 2","Programaci√≥n Y Control De PYT"]},
{n:"Pr√°ctica Supervisada 3",p:["Representaci√≥n Arquitect√≥nica 6","Pr√°ctica Supervisada 2","Dise√±o Arquitect√≥nico 9","Programaci√≥n Y Control De PYT","Gesti√≥n Profesional","Ciudad Y Territorio"]},
{n:"Gesti√≥n Urbana Y Territorial",p:["Taller De Urbanismo","Dise√±o Arquitect√≥nico 9","Gesti√≥n Profesional","Ciudad Y Territorio"]},
{n:"Trabajo De Graduaci√≥n 2",p:["Trabajo De Graduaci√≥n 1"]}]}]}];

function render(){
const m=document.getElementById("malla");
m.innerHTML="";
let total=0,ok=0;

data.forEach(a=>{
 const d=document.createElement("div");
 d.className="ano";
 d.innerHTML=`<h2>${a.a√±o}</h2>`;
 a.semestres.forEach(s=>{
  const sd=document.createElement("div");
  sd.className="semestre";
  sd.innerHTML=`<h3>${s.nombre}</h3>`;
  s.materias.forEach(x=>{
   total++;
   let nombre=typeof x==="string"?x:x.n;
   let p=typeof x==="string"?[]:x.p;
   const div=document.createElement("div");
   div.className="materia";
   div.textContent=nombre;
   const aprobado=localStorage.getItem(nombre);
   if(aprobado){div.classList.add("aprobada");ok++}
   const faltan=p.filter(r=>!localStorage.getItem(r));
   if(faltan.length){
    div.classList.add("bloqueada");
    div.dataset.tooltip="Falta: "+faltan.join(", ");
   }
  div.onclick=()=>{
  if(div.classList.contains("bloqueada")) return;

  if(aprobado){
    localStorage.removeItem(nombre);
  } else {
    localStorage.setItem(nombre,"ok");
  }

  guardarProgreso();
  render();
};
   sd.appendChild(div);
  });
  d.appendChild(sd);
 });
 m.appendChild(d);
});

const pct=Math.round(ok/total*100);
document.getElementById("barra").style.width=pct+"%";
document.getElementById("porcentaje").textContent="Progreso: "+pct+"%";
let msg=mensajes[0].m;
mensajes.forEach(x=>{if(pct>=x.p)msg=x.m});
document.getElementById("mensaje").textContent=msg;
}

function reiniciar(){
 if(confirm("¬øBorrar todo el progreso?")){
  localStorage.clear();
  guardarProgreso();
  render();
 }
}
render();
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyDGFEsBWnEHP3luKaeaFzUe_Nguqz3j_pA",
  authDomain: "malla-curricular-arquitectura.firebaseapp.com",
  projectId: "malla-curricular-arquitectura",
  storageBucket: "malla-curricular-arquitectura.firebasestorage.app",
  messagingSenderId: "613677284410",
  appId: "1:613677284410:web:92297cf4c86a6f6c378903",
  measurementId: "G-YN189BKMCH"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth();
const provider = new GoogleAuthProvider();

let userId = null;

// ---------- LOGIN GOOGLE ----------
window.loginGoogle = async function () {
  await signInWithPopup(auth, provider);
};

// ---------- LOGOUT ----------
window.logout = async function () {
  await signOut(auth);
  localStorage.clear();
  render();
};

// ---------- CUANDO HAY USUARIO ----------
onAuthStateChanged(auth, async (user) => {
  const status = document.getElementById("estadoLogin");

  if (user) {
    userId = user.uid;
    status.textContent = "Conectado: " + user.email;

    await cargarProgreso();
    render();
    escucharCambios();
  } else {
    status.textContent = "Sin iniciar sesi√≥n";
    render();
  }
});

// ---------- GUARDAR EN FIRESTORE ----------
async function guardarProgreso() {
  if (!userId) return;

  const data = {};
  for (let i = 0; i < localStorage.length; i++) {
    const k = localStorage.key(i);
    data[k] = true;
  }
  await setDoc(doc(db, "progresos", userId), data);
}

// ---------- CARGAR DESDE FIRESTORE ----------
async function cargarProgreso() {
  const snap = await getDoc(doc(db, "progresos", userId));
  if (snap.exists()) {
    localStorage.clear();
    const d = snap.data();
    Object.keys(d).forEach(k => localStorage.setItem(k, "ok"));
  }
}

// ---------- ESCUCHAR CAMBIOS ----------
function escucharCambios() {
  onSnapshot(doc(db, "progresos", userId), (snap) => {
    if (snap.exists()) {
      localStorage.clear();
      const d = snap.data();
      Object.keys(d).forEach(k => localStorage.setItem(k, "ok"));
      render();
    }
  });
}

window.guardarProgreso = guardarProgreso;
</script>
</body>
</html>
